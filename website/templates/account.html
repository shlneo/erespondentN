{% extends "base.html" %}
{% block title %}–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç - ErespondentN{% endblock %}
{% block content %}

<div class = "account_cont">
    <div class = "privetstvie_cont">
        <a href = "/profile/session">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å{{' ' + current_user.fio.split()[0] + ' ' + current_user.fio.split()[1] if current_user.fio else ''}}</a>
    </div>
    <div class = "account_functions">
        <div class = "account_links">
            <button class = "account_buttons" onclick="window.location.href='/profile/common'">
                <div class="first_path">
                    <img src="{{ url_for('static', filename='img/people.png')}}"  alt="">
                    <span>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ—Ñ–∏–ª—è</span>
                </div>
                <svg fill="#002762" height="12" viewBox="0 0 7 12" width="7" xmlns="http://www.w3.org/2000/svg" style="margin-left: 4px;"><path d="M5.83327 4.23243L2.00911 0.410763C1.85043 0.267295 1.64267 0.19034 1.42882 0.195832C1.21498 0.201323 1.01143 0.288839 0.860333 0.440261C0.709232 0.591683 0.622148 0.795412 0.617111 1.00927C0.612074 1.22312 0.68947 1.43073 0.833274 1.5891L4.65494 5.41076C4.81117 5.56704 4.89893 5.77896 4.89893 5.99993C4.89893 6.2209 4.81117 6.43282 4.65494 6.5891L0.833274 10.4108C0.677017 10.5671 0.589277 10.7792 0.589356 11.0002C0.589434 11.2213 0.677324 11.4333 0.833691 11.5895C0.990058 11.7458 1.20209 11.8335 1.42315 11.8334C1.64421 11.8334 1.85618 11.7455 2.01244 11.5891L5.83327 7.76743C6.30195 7.29861 6.56524 6.66284 6.56524 5.99993C6.56524 5.33702 6.30195 4.70125 5.83327 4.23243Z"></path></svg>
            </button>
            <button class = "account_buttons" onclick="window.location.href='/FAQ'">
                <div class="first_path">
                    <img src="{{ url_for('static', filename='img/faq.png')}}"  alt="">
                    <span>–û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã</span>
                </div>
                <svg fill="#002762" height="12" viewBox="0 0 7 12" width="7" xmlns="http://www.w3.org/2000/svg" style="margin-left: 4px;"><path d="M5.83327 4.23243L2.00911 0.410763C1.85043 0.267295 1.64267 0.19034 1.42882 0.195832C1.21498 0.201323 1.01143 0.288839 0.860333 0.440261C0.709232 0.591683 0.622148 0.795412 0.617111 1.00927C0.612074 1.22312 0.68947 1.43073 0.833274 1.5891L4.65494 5.41076C4.81117 5.56704 4.89893 5.77896 4.89893 5.99993C4.89893 6.2209 4.81117 6.43282 4.65494 6.5891L0.833274 10.4108C0.677017 10.5671 0.589277 10.7792 0.589356 11.0002C0.589434 11.2213 0.677324 11.4333 0.833691 11.5895C0.990058 11.7458 1.20209 11.8335 1.42315 11.8334C1.64421 11.8334 1.85618 11.7455 2.01244 11.5891L5.83327 7.76743C6.30195 7.29861 6.56524 6.66284 6.56524 5.99993C6.56524 5.33702 6.30195 4.70125 5.83327 4.23243Z"></path></svg>
            </button>
            {%if current_user.type == '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' or current_user.type == '–†–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç'%}
                <button class = "button_account_add_report blue_button" onclick="window.location.href='/report-area'" type="" class = "">
                    <span style = "font-size: 20px;">+</span>
                    <span>–î–æ–±–∞–≤–∏—Ç—å –æ—Ç—á–µ—Ç</span>
                </button>
            {%else%}
            {%endif%}
            {%if current_user.type == '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' or current_user.type == '–ê—É–¥–∏—Ç–æ—Ä'%}
             <button class = "account_buttons" onclick="window.location.href='/audit-area/not_viewed?year={{previous_year}}&quarter={{previous_quarter}}';">
                <div class="first_path">
                    <img src="{{ url_for('static', filename='img/audit_icon.png')}}"  alt="">
                    <span>–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—á–µ—Ç–æ–≤</span>
                </div>
                <svg fill="#002762" height="12" viewBox="0 0 7 12" width="7" xmlns="http://www.w3.org/2000/svg" style="margin-left: 4px;"><path d="M5.83327 4.23243L2.00911 0.410763C1.85043 0.267295 1.64267 0.19034 1.42882 0.195832C1.21498 0.201323 1.01143 0.288839 0.860333 0.440261C0.709232 0.591683 0.622148 0.795412 0.617111 1.00927C0.612074 1.22312 0.68947 1.43073 0.833274 1.5891L4.65494 5.41076C4.81117 5.56704 4.89893 5.77896 4.89893 5.99993C4.89893 6.2209 4.81117 6.43282 4.65494 6.5891L0.833274 10.4108C0.677017 10.5671 0.589277 10.7792 0.589356 11.0002C0.589434 11.2213 0.677324 11.4333 0.833691 11.5895C0.990058 11.7458 1.20209 11.8335 1.42315 11.8334C1.64421 11.8334 1.85618 11.7455 2.01244 11.5891L5.83327 7.76743C6.30195 7.29861 6.56524 6.66284 6.56524 5.99993C6.56524 5.33702 6.30195 4.70125 5.83327 4.23243Z"></path></svg>
            </button>
            <button class = "account_buttons" id = "link_stats">
                <div class="first_path">
                    <img src="{{ url_for('static', filename='img/report.png')}}"  alt="">
                    <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                </div>
                <svg fill="#002762" height="12" viewBox="0 0 7 12" width="7" xmlns="http://www.w3.org/2000/svg" style="margin-left: 4px;"><path d="M5.83327 4.23243L2.00911 0.410763C1.85043 0.267295 1.64267 0.19034 1.42882 0.195832C1.21498 0.201323 1.01143 0.288839 0.860333 0.440261C0.709232 0.591683 0.622148 0.795412 0.617111 1.00927C0.612074 1.22312 0.68947 1.43073 0.833274 1.5891L4.65494 5.41076C4.81117 5.56704 4.89893 5.77896 4.89893 5.99993C4.89893 6.2209 4.81117 6.43282 4.65494 6.5891L0.833274 10.4108C0.677017 10.5671 0.589277 10.7792 0.589356 11.0002C0.589434 11.2213 0.677324 11.4333 0.833691 11.5895C0.990058 11.7458 1.20209 11.8335 1.42315 11.8334C1.64421 11.8334 1.85618 11.7455 2.01244 11.5891L5.83327 7.76743C6.30195 7.29861 6.56524 6.66284 6.56524 5.99993C6.56524 5.33702 6.30195 4.70125 5.83327 4.23243Z"></path></svg>
            </button>
        {%else%}
        {%endif%}

        {%if current_user.type == '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'%}
            <button class = "account_buttons" onclick="window.location.href='/admin'">
                <div class="first_path">
                    <img src="{{ url_for('static', filename='img/icon_admin-panel.png')}}"  alt="">
                    <span>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</span>
                </div>
                <svg fill="#002762" height="12" viewBox="0 0 7 12" width="7" xmlns="http://www.w3.org/2000/svg" style="margin-left: 4px;"><path d="M5.83327 4.23243L2.00911 0.410763C1.85043 0.267295 1.64267 0.19034 1.42882 0.195832C1.21498 0.201323 1.01143 0.288839 0.860333 0.440261C0.709232 0.591683 0.622148 0.795412 0.617111 1.00927C0.612074 1.22312 0.68947 1.43073 0.833274 1.5891L4.65494 5.41076C4.81117 5.56704 4.89893 5.77896 4.89893 5.99993C4.89893 6.2209 4.81117 6.43282 4.65494 6.5891L0.833274 10.4108C0.677017 10.5671 0.589277 10.7792 0.589356 11.0002C0.589434 11.2213 0.677324 11.4333 0.833691 11.5895C0.990058 11.7458 1.20209 11.8335 1.42315 11.8334C1.64421 11.8334 1.85618 11.7455 2.01244 11.5891L5.83327 7.76743C6.30195 7.29861 6.56524 6.66284 6.56524 5.99993C6.56524 5.33702 6.30195 4.70125 5.83327 4.23243Z"></path></svg>
            </button>
        {%else%}
        {%endif%}
            
        </div>
        <div class="account_messages">
            <div class="account_messageArea">
                <img src="{{ url_for('static', filename='img/icon_messages.png')}}" alt="">
                <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
            </div>
            <div class="message_cont" id="messagesContainer">
                {% if messages %}
                    {% for row in messages %}
                    <div class="mes" id="message-{{ row.id }}">
                        <div class="message_header">
                            <div class="time_mes">
                                {{ row.create_time.strftime('%d.%m.%Y %H:%M') }}
                                {% if row.sender_id != None %} 
                                - <span class="sender">
                                    {% if row.sender.type == "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä" %}
                                        –°–∏—Å—Ç–µ–º–∞
                                    {% else %}
                                        {{ row.sender.email }}
                                    {% endif %}
                                </span>
                                {% endif %}
                            </div>
                            <div class="message_actions">
                                <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–≤–µ—Ç–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ -->
                                {% if current_user.type == "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä" and row.sender_id != current_user.id and row.sender_id != None %}
                                <button class="reply_btn" 
                                        onclick="showReplyForm({{ row.id }}, 
                                            {% if row.sender.type == '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' %}
                                                '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'
                                            {% else %}
                                                '{{ row.sender.email|e }}'
                                            {% endif %})"
                                        title="–û—Ç–≤–µ—Ç–∏—Ç—å"
                                        data-message-id="{{ row.id }}">
                                    –û—Ç–≤–µ—Ç–∏—Ç—å
                                </button>
                                {% endif %}
                                
                                <button class="delete_btn" 
                                        onclick="deleteMessage({{ row.id }})"
                                        title="–£–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ"
                                        data-message-id="{{ row.id }}">
                                    ‚úï
                                </button>
                            </div>
                        </div>
                        <div class="text_mes">{{ row.text }}</div>
                        
                        <!-- –§–æ—Ä–º–∞ –æ—Ç–≤–µ—Ç–∞ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞) -->
                        <div class="reply_form" id="replyForm-{{ row.id }}" style="display: none;">
                            <textarea class="reply_textarea" 
                                    id="replyText-{{ row.id }}" 
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç..." 
                                    rows="3"></textarea>
                            <div class="reply_actions">
                                <button class="reply_submit_btn" onclick="submitReply({{ row.id }})">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                                <button class="reply_cancel_btn" onclick="cancelReply({{ row.id }})">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                <div class="mes empty">
                    <div class="text_mes">–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div id="load_stats_modal" class="modal">
    <div class="modal-content">
        <div class = "modal-header">
            <h3 class = "change-position">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</h3>
            <a class="close" id = "Closeperiod_modal">&times;</a>
        </div>
        <div class="answer-highlight-second" style = "max-width: 510px;">
            <div class="highlight-icon">üí°</div>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π <strong>–≥–æ–¥</strong> –∏ <strong>–∫–≤–∞—Ä—Ç–∞–ª</strong>, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ—Ç—á–µ—Ç –æ —Å–ø–∏—Å–∫–µ <strong>–æ—Ç—á–∏—Ç–∞–≤—à–∏—Ö—Å—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π</strong>.</p>
        </div>
        <form action="/load_org_stat" method="POST">
            <table class="modal_table">      
                <tr>
                    <td>–ì–æ–¥</td>
                    <td>
                        <div class="input-container">
                            <button class="inc_button" type="button" onclick="changeValueByButton(this)">-</button>
                            <input class="inc_dis_input" type="text" 
                                id="coppy_quantity_year" 
                                value="{{previous_year}}" 
                                name="modal_report_year" 
                                data-type="year"
                                readonly>
                            <button class="dis_button" type="button" onclick="changeValueByButton(this)">+</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>–ö–≤–∞—Ä—Ç–∞–ª</td>
                    <td>
                        <div class="input-container">
                            <button class="inc_button" type="button" onclick="changeValueByButton(this)">-</button>
                            <input class="inc_dis_input" type="text" 
                                id="coppy_quantity_quarter" 
                                value="{{previous_quarter}}" 
                                name="modal_report_quarter" 
                                data-type="quarter"
                                readonly>
                            <button class="dis_button" type="button" onclick="changeValueByButton(this)">+</button>
                        </div>
                    </td>
                </tr>
            </table>
            <div class="model_but_area" >
                <button type="submit" class="blue_button">
                    <img src="/static/img/Calendar.svg" alt="" class="button-icon">
                    <span>–í—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥</span>
                </button>
            </div>
        </form>
    </div>
</div>
<script>
</script>
{% endblock %}