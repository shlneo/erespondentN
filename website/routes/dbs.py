from datetime import datetime

from flask import (
    Blueprint, json, jsonify, make_response, request
)

from website.models import DirProduct, DirUnit
from .. import db

dbs = Blueprint('dbs', __name__)

@dbs.route('/units', methods=['POST', 'GET'])
def units():
    if request.method == 'GET':
        all_units = DirUnit.query.all()

        units_list = []
        for unit in all_units:
            units_list.append({
                'id': unit.IdUnit,
                'code': unit.CodeUnit,
                'name': unit.NameUnit
            })
        
        response = make_response(json.dumps(units_list, ensure_ascii=False, indent=2))
        response.headers['Content-Type'] = 'application/json; charset=utf-8'
        return response
    
    elif request.method == 'POST':
        return jsonify({
            'success': False,
            'message': 'POST method not implemented yet'
        }), 405
        
@dbs.route('/units/add', methods=['GET'])
def add_units():
    units_to_add = [
        "Гкал/час",
        "м3 привед.",
        "час работы оборудования",
        "вагоно-сут.",
        "тыс. шт. усл. кирпич",
        "койко-сут.",
        "голов",
    ]
    
    max_id = db.session.query(db.func.max(DirUnit.IdUnit)).scalar() or 0
    current_id = max_id
    
    for code in units_to_add:
        current_id += 1
        new_unit = DirUnit(
            IdUnit=current_id,
            CodeUnit=code,
            NameUnit=code
        )
        db.session.add(new_unit)

    db.session.commit()
    return f"Successfully added {len(units_to_add)} units"

@dbs.route('/products', methods=['POST', 'GET'])
def products():
    if request.method == 'GET':
        all_prod = DirProduct.query.all()

        prod_list = []
        for prod in all_prod:
            prod_list.append({
                'id': prod.id,
                'code': prod.CodeProduct,
                'name': prod.NameProduct,
                'is_fuel': prod.IsFuel,
                'is_heat': prod.IsHeat,
                'is_electro': prod.IsElectro,
                'unit_id': prod.IdUnit,
                'unit_name': prod.unit.NameUnit if prod.unit else None,
                'date_start': prod.DateStart.isoformat() if prod.DateStart else None,
                'date_end': prod.DateEnd.isoformat() if prod.DateEnd else None
            })
        
        response = make_response(json.dumps(prod_list, ensure_ascii=False, indent=2))
        response.headers['Content-Type'] = 'application/json; charset=utf-8'
        return response
    
    elif request.method == 'POST':
        return jsonify({
            'success': False,
            'message': 'POST method not implemented yet'
        }), 405
        
@dbs.route('/products/set-dates-if-empty', methods=['POST'])
def set_products_dates_if_empty():
    try:
        target_date_start = datetime.strptime('2025-07-15', '%Y-%m-%d').date()
        target_date_end = datetime.strptime('2026-01-01', '%Y-%m-%d').date()
        
        all_prod = DirProduct.query.all()
        updated_count = 0
        skipped_count = 0
        
        for prod in all_prod:
            date_start_empty = prod.DateStart is None
            date_end_empty = prod.DateEnd is None
            
            if date_start_empty or date_end_empty:
                if date_start_empty:
                    prod.DateStart = target_date_start
                if date_end_empty:
                    prod.DateEnd = target_date_end
                updated_count += 1
            else:
                skipped_count += 1
        
        db.session.commit()
        
        return jsonify({
            'success': True,
            'message': f'Даты обновлены для {updated_count} продуктов, пропущено {skipped_count} (уже заполнены)',
            'date_start': '2025-07-15',
            'date_end': '2026-01-01',
            'updated_count': updated_count,
            'skipped_count': skipped_count
        }), 200
        
    except Exception as e:
        db.session.rollback()
        return jsonify({
            'success': False,
            'message': f'Ошибка при обновлении дат: {str(e)}'
        }), 500
        
@dbs.route('/products/add', methods=['GET'])
def add_products():
    
    date_start = datetime.strptime('2026-01-01', '%Y-%m-%d').date()
    
    products_to_add = [
        # ('код продукции', 'Наименование', IsFuel, IsHeat, IsElectro, IdUnit)
        ('0010', 'Электроэнергия, отпущенная электростанциями, работающими на котельно-печном топливе', True, False, False, 1),  # тыс. кВт. ч
        ('0011', 'Электроэнергия, израсходованная на собственные нужды электростанций: на производство теплоэнергии', False, False, True, 2),  # тыс. кВт. ч
        ('0012', 'Электроэнергия, израсходованная на собственные нужды электростанций: на производство электроэнергии', False, False, True, 1),  # тыс. кВт. ч
        ('0015', 'Электроэнергия, отпущенная когенерационными и иными подобными установками', True, False, False, 1),  # тыс. кВт. ч
        ('0016', 'Тепловая энергия, отпущенная когенерационными и иными подобными установками', True, False, True, 2),  # Гкал
        ('0017', 'Электроэнергия, израсходованная на собственные нужды когенерационными и иными подобными установками на производство электроэнергии', False, False, True, 72),  # %
        ('0020', 'Теплоэнергия, отпущенная электростанциями и районными котельными', True, False, True, 2),  # Гкал  
        ('0021', 'Теплоэнергия, отпущенная электростанциями и районными котельными в том числе отпущенная районными котельными', True, False, True, 2),  # Гкал
        ('0024', 'Теплоэнергия, отпущенная промышленно-производственными котельными производительностью 10 Гкал/час и более', True, False, True, 2),  # Гкал
        ('0025', 'Теплоэнергия, отпущенная промышленно-производственными котельными производительностью от 0,5 до 10 Гкал/час', True, False, True, 2),  # Гкал
        ('0026', 'Теплоэнергия, отпущенная отопительными котельными производительностью 10 Гкал/час и более', True, False, True, 2),  # Гкал
        ('0027', 'Теплоэнергия, отпущенная отопительными котельными производительностью от 0,5 до 10 Гкал/час', True, False, True, 2),  # Гкал
        ('0030', 'Теплоэнергия, отпущенная отопительно-производственными котельными, производительностью 10 Гкал/час и более', True, False, True, 2),  # Гкал
        ('0031', 'Теплоэнергия, отпущенная отопительно-производственными котельными производительностью от 0,5 до 10 Гкал/час', True, False, True, 2),  # Гкал
        ('0035', 'Транспортировка тепловой энергии до потребителя', False, False, True, 2),  # Гкал
        ('0040', 'Потери электроэнергии в электрических сетях Белорусской энергетической системы', False, False, True, 71),  # % (включая покупную)
        ('0041', 'Производственные, хозяйственные нужды и прочие виды деятельности Белорусской энергетической системы', False, False, True, 2),  # Гкал
        ('0042', 'Производственные, хозяйственные нужды и прочие виды деятельности Белорусской энергетической системы', False, False, True, 1),  # тыс. кВт. ч
        ('0050', 'Потери теплоэнергии в магистральных тепловых сетях Белорусской энергетической системы', False, True, False, 71),  # % (включая покупную)
        ('0051', 'Потери теплоэнергии в магистральных тепловых сетях организаций других республиканских органов государственного управления', False, True, False, 72),  # %
        ('0052', 'Потери теплоэнергии в тепловых сетях организаций при транзите тепловой энергии от сторонних организаций', False, True, False, 72),  # %
        ('0053', 'Потери теплоэнергии в квартальных тепловых сетях организаций', False, True, False, 72),  # %
        ('0060', 'Добыча нефти всеми способами, включая газовый конденсат (с учетом расхода на внутрипромышленную перекачку, вторичные методы эксплуатации и водоснабжения) – всего', True, False, True, 3),  # т
        ('0065', 'Добыча нефти всеми способами, включая газовый конденсат (с учетом расхода на внутрипромышленную перекачку, вторичные методы эксплуатации и водоснабжения) – всего в том числе: методом водотеплового воздействия', True, False, True, 3),  # т
        ('0066', 'Добыча нефти всеми способами, включая газовый конденсат (с учетом расхода на внутрипромышленную перекачку, вторичные методы эксплуатации и водоснабжения) – всего в том числе: методом паротеплового воздействия', True, False, True, 3),  # т
        ('0067', 'Добыча нефти всеми способами, включая газовый конденсат (с учетом расхода на внутрипромышленную перекачку, вторичные методы эксплуатации и водоснабжения) – всего в том числе: газлифтная', True, False, True, 3),  # т
        ('0068', 'Добыча нефти всеми способами, включая газовый конденсат (с учетом расхода на внутрипромышленную перекачку, вторичные методы эксплуатации и водоснабжения) – всего в том числе: прочие', True, False, True, 3),  # т
        ('0070', 'Бурение нефтегазовых скважин разведочное', True, True, True, 4),  # пог.м проход
        ('0080', 'Бурение нефтегазовых скважин эксплуатационное', True, True, True, 4),  # пог.м проход
        ('0090', 'Подготовка нефти на промыслах', False, True, True, 3),  # т
        ('0140', 'Переработка нефти, включая газовый конденсат – всего', True, True, True, 3),  # т
        ('0141', 'Переработка нефти, включая газовый конденсат в том числе: первичная переработка нефти', True, True, True, 3),  # т
        ('0142', 'Переработка нефти, включая газовый конденсат в том числе: гидрокрекинг', True, True, True, 3),  # т
        ('0145', 'Переработка нефти, включая газовый конденсат в том числе: каталитический риформинг', True, True, True, 3),  # т
        ('0146', 'Переработка нефти, включая газовый конденсат в том числе: производство масел', True, True, True, 3),  # т
        ('0148', 'Переработка нефти, включая газовый конденсат в том числе: гидроочистка', True, True, True, 3),  # т
        ('0149', 'Переработка нефти, включая газовый конденсат в том числе: каталитический риформинг для получения ароматических углеводородов', True, True, True, 3),  # т
        ('0152', 'Переработка нефти, включая газовый конденсат в том числе: парекс', True, True, True, 3),  # т
        ('0170', 'Переработка газа', True, True, True, 5),  # тыс. м3
        ('0290', 'Топливные брикеты', True, True, True, 3),  # т
        ('0291', 'Пеллеты, гранулы', True, True, True, 3),  # т
        ('0295', 'Щепа топливная', True, True, True, 3),  # т
        ('0300', 'Добыча и переработка торфа', True, True, True, 3),  # т
        ('0380', 'Кислород', True, True, True, 5),  # тыс. м3
        ('0385', 'Водород', True, True, True, 6),  # м
        ('0390', 'Сжатый воздух, отпущенный (проданный) на сторону при t = 20 °С и Р = 1,4 атм.', True, True, True, 68),  # тыс. м3 привед
        ('0410', 'Чугун', True, True, True, 3),  # т
        ('0460', 'Прокат черных металлов (включая поковки из слитков)', True, True, True, 3),  # т
        ('0470', 'Трубы стальные', True, True, True, 3),  # т
        ('0471', 'Фасонные части для стальных труб', True, False, True, 3),  # т
        ('0480', 'Трубы чугунные напорные', True, True, False, 3),  # т
        ('0481', 'Фасонные части для чугунных труб', True, False, True, 3),  # т
        ('0490', 'ПИ-трубы', True, True, True, 73),  # п.м
        ('0491', 'Фасонные части для ПИ-труб', True, True, True, 36),  # усл. шт
        ('0690', 'Метизы (из готового проката) – всего', True, False, True, 3),  # т
        ('0755', 'Добыча других руд и горных масс – всего', False, False, True, 3),  # т
        ('1160', 'Сера – всего', True, True, True, 3),  # т
        ('1163', 'Сера – всего в том числе сера газовая', True, True, True, 3),  # т
        ('1180', 'Аммиак синтетический – всего', True, True, True, 3),  # т
        ('1181', 'Аммиак синтетический – всего в том числе произведенный на: агрегатах М-400, М-450', False, True, True, 3),  # т
        ('1182', 'Аммиак синтетический – всего в том числе произведенный на: других агрегатах', False, True, True, 3),  # т
        ('1220', 'Кислота серная (в пересчете на 100 % содержания, кроме отработанной)', True, False, True, 3),  # т
        ('1300', 'Азот', False, False, True, 5),  # тыс. м3
        ('1310', 'Аргон', False, False, True, 5),  # тыс. м3
        ('1320', 'Натрий сернокислый 100 %', False, True, True, 3),  # т
        ('1350', 'Минеральные удобрения – всего', False, True, True, 3),  # т
        ('1360', 'Минеральные удобрения – всего в том числе: калийные удобрения в пересчете на 100 % К2О', False, True, True, 3),  # т
        ('1370', 'Минеральные удобрения – всего в том числе: фосфатные удобрения в пересчете на 100 % Р2О5', False, True, True, 3),  # т
        ('1380', 'Минеральные удобрения – всего в том числе: азотные удобрения в пересчете на 100 % N2', False, True, True, 3),  # т
        ('1400', 'Волокна и нити химические – всего', True, True, True, 3),  # т
        ('1401', 'нити текстильные синтетические: капроновые', True, True, True, 3),  # т
        ('1402', 'нити текстильные синтетические: полиэфирные', True, True, True, 3),  # т
        ('1404', 'нити синтетические для корда и техники: капроновые', True, True, True, 3),  # т
        ('1406', 'нити синтетические для корда и техники: полиэфирные', True, True, True, 3),  # т
        ('1407', 'нити синтетические для корда и техники: полипропиленовые', True, True, True, 3),  # т
        ('1409', 'волокна синтетические: капроновые', True, True, True, 3),  # т
        ('1411', 'волокна синтетические: полиэфирные', True, True, True, 3),  # т
        ('1413', 'волокна синтетические: полиакрилонитрильные', True, True, True, 3),  # т
        ('1415', 'волокна синтетические: поливинилхлоридные', True, True, True, 3),  # т
        ('1416', 'нити текстильные искусственные: вискозные', True, True, True, 3),  # т
        ('1419', 'нити текстильные искусственные: для кордной ткани и технических изделий', True, True, True, 3),  # т
        ('1420', 'волокна искусственные: вискозные', True, True, True, 3),  # т
        ('1422', 'волокна искусственные: прочие виды волокон и нитей химических', True, True, True, 3),  # т
        ('1430', 'Смолы синтетические и пластмассы – всего', True, True, True, 3),  # т
        ('1431', 'полиэтилен высокого давления', True, True, True, 3),  # т
        ('1434', 'смолы карбамидные', True, True, True, 3),  # т
        ('1435', 'диметилтерефталат', True, True, True, 3),  # т
        ('1437', 'капролактам', True, True, True, 3),  # т
        ('1438', 'дисперсии (эмульсии) поливинилацетатные', True, True, True, 3),  # т
        ('1443', 'прочие виды синтетических смол и пластмасс', True, True, True, 3),  # т
        ('1444', 'полиэтилентерефталат', True, True, True, 3),  # т
        ('1445', 'Терефталевая кислота', True, True, True, 3),  # т
        ('1446', 'Ангидрид фталевый', True, True, True, 3),  # т
        ('1447', 'Лаки на конденсационных смолах', True, True, True, 3),  # т
        ('1448', 'Эмали, грунтовки и шпатлевки на конденсационных смолах', True, True, True, 3),  # т
        ('1450', 'Химические средства защиты растений', True, True, True, 3),  # т
        ('1660', 'Автомотошины', False, True, True, 7),  # шт
        ('1680', 'Литье чугунное', True, True, True, 3),  # т
        ('1700', 'Литье цветное', True, True, True, 3),  # т
        ('1710', 'Литье стальное', True, True, True, 3),  # т
        ('1800', 'Сушка древесины', True, True, True, 10),  # м3
        ('1810', 'Пиломатериалы', True, True, True, 10),  # м3
        ('1820', 'Шпон лущеный', True, True, True, 10),  # м3
        ('1830', 'Шпон строганый', True, True, True, 5),  # тыс. м3
        ('1860', 'Плиты древесностружечные', True, True, True, 8),  # усл. м3
        ('1870', 'Плиты древесноволокнистые', True, True, True, 9),  # м2
        ('1880', 'Сэндвич панели', True, True, True, 14),  # тыс. м2
        ('1890', 'Деревянные изделия', True, True, True, 10),  # м3
        ('1891', 'Прочие продукты лесопереработки', True, True, True, 11),  # усл. ед.
        ('1900', 'Смола древесная и продукты ее переработки', True, True, True, 3),  # т
        ('1930', 'Мебель', True, True, True, 11),  # усл. ед.
        ('1970', 'Целлюлоза – всего', True, True, True, 3),  # т
        ('1980', 'Бумага', True, True, True, 3),  # т
        ('1981', 'Полиграфические изделия', True, True, True, 12),  # тыс. усл. ед.
        ('1982', 'Обои', True, True, True, 64),  # тыс. усл. кус
        ('1990', 'Картон и изделия из него', True, True, True, 3),  # т
        ('2000', 'Цемент – всего', True, True, True, 3),  # т
        ('2001', 'Цемент – всего из него клинкер', True, True, True, 3),  # т
        ('2010', 'Известь', True, True, True, 3),  # т
        ('2015', 'Гипс и изделия из него', True, True, True, 3),  # т
        ('2016', 'Мука известняковая и продукты ее переработки', True, True, True, 3),  # т
        ('2020', 'Кирпич глиняный', True, True, True, 80),  # тыс. шт. усл. кирпич
        ('2030', 'Кирпич силикатный', True, True, True, 80),  # тыс. шт. усл. кирпич
        ('2035', 'Металлоконструкции', True, True, True, 3),  # т
        ('2036', 'Металлоизделия', True, True, True, 36),  # усл. шт
        ('2050', 'Шифер', False, True, True, 12),  # тыс. усл. ед.
        ('2055', 'Мягкие кровельные материалы', True, True, True, 14),  # тыс. м2
        ('2056', 'Синтетические покрытия', False, True, True, 9),  # м2
        ('2060', 'Бетонные и железобетонные изделия', True, True, True, 10),  # м3
        ('2070', 'Товарный бетон и раствор', True, True, True, 10),  # м3
        ('2080', 'Товарная арматура', False, False, True, 3),  # т
        ('2132', 'Столярные изделия', True, True, True, 9),  # м2
        ('2134', 'Погонажные изделия', False, True, True, 15),  # тыс. пог. м
        ('2180', 'Производство теплоизоляционных материалов', True, True, True, 10),  # м3
        ('2210', 'Керамзит и изделия из него', True, True, True, 10),  # м3
        ('2255', 'Производство нерудных материалов', True, True, True, 75),  # м3, т
        ('2270', 'Асфальт и асфальтобетон', True, True, True, 3),  # т
        ('2310', 'Стекло и изделия из него', True, True, True, 12),  # тыс. усл. ед.
        ('2315', 'Стекловолокно и изделия из него', True, True, True, 3),  # т
        ('2320', 'Глина и керамические изделия', True, True, True, 3),  # т
        ('2340', 'Резинотехнические изделия', False, True, True, 3),  # т
        ('2350', 'Лакокрасочные изделия', True, True, True, 3),  # т
        ('2360', 'Плиты и прочие изделия из природных камней', False, True, True, 9),  # м2
        ('2370', 'Плитки керамические', True, True, True, 10),  # м2, м³
        ('2400', 'Ткани', True, True, True, 14),  # тыс. м2
        ('2410', 'Изделия из кожи', False, True, True, 16),  # тыс. дм2
        ('2420', 'Мех искусственный', False, True, True, 14),  # тыс. м2
        ('2430', 'Ковры и ковровые изделия', False, True, True, 14),  # тыс. м2
        ('2440', 'Чулочно-носочные изделия', False, False, False, 17),  # тыс. пар
        ('2441', 'Чулочно-носочные изделия', False, False, False, 18),  # тыс. ед.   
        ('2450', 'Трикотажные изделия', False, True, True, 18),  # тыс. ед.
        ('2451', 'Трикотажные изделия', False, True, True, 12),  # тыс. усл. ед.
        ('2460', 'Обувь кожаная', False, True, True, 19),  # тыс. усл. пар
        ('2470', 'Обувь резиновая', True, True, True, 19),  # тыс. усл. пар
        ('2480', 'Швейные изделия', False, True, True, 11),  # усл. ед.
        ('2481', 'Трикотажное полотно готовое', True, True, True, 20),  # усл. т
        ('2490', 'Пряжа – всего', True, True, True, 3),  # т
        ('2500', 'Цельномолочная продукция в пересчете на молоко', True, True, True, 3),  # т
        ('2501', 'Мороженое и десерты', False, True, True, 3),  # т
        ('2510', 'Молочный сахар', False, True, True, 3),  # т
        ('2520', 'Обезжиренная молочная продукция в пересчете на молоко', True, True, True, 3),  # т
        ('2530', 'Солод пивоваренный', True, True, True, 3),  # т
        ('2540', 'Маргариновая продукция', False, True, True, 3),  # т
        ('2550', 'Майонез', False, True, True, 3),  # т
        ('2560', 'Консервы молочные', False, True, True, 22),  # тыс. усл. банк
        ('2570', 'Мыло и моющие средства', False, True, True, 3),  # т
        ('2580', 'Мясо (включая субпродукты 1 категории)', True, True, True, 3),  # т
        ('2581', 'Субпродукты 2 категории', True, True, True, 3),  # т
        ('2584', 'Прочая продукция мясопереработки', True, True, True, 3),  # т
        ('2585', 'Полуфабрикаты', True, True, True, 3),  # т
        ('2590', 'Производство молока', False, True, True, 3),  # т
        ('2600', 'Концентраты пищевые', False, True, True, 3),  # т
        ('2610', 'Консервы мясные', False, True, True, 22),  # тыс. усл. банк
        ('2620', 'Масло животное', False, True, True, 3),  # т
        ('2630', 'Сыры жирные', False, True, True, 3),  # т
        ('2635', 'Сыры нежирные', False, True, True, 3),  # т
        ('2636', 'Сыры плавленые', True, True, True, 3),  # т
        ('2640', 'Сухие молочные изделия и смеси', True, True, True, 3),  # т
        ('2650', 'Колбасные изделия', True, True, True, 3),  # т
        ('2660', 'Пиво', False, True, True, 23),  # тыс. дал
        ('2665', 'Безалкогольные напитки', True, True, True, 23),  # тыс. дал
        ('2670', 'Производство холода', False, True, True, 2),  # Гкал 
        ('2680', 'Консервы рыбные', True, True, True, 22),  # тыс. усл. банок
        ('2681', 'Прочая рыбная продукция', True, True, True, 3),  # т
        ('2690', 'Консервы плодоовощные', True, True, True, 22),  # тыс. усл. банок
        ('2695', 'Сушеные овощи', True, True, True, 3),  # т
        ('2696', 'Прочая плодовоовощная продукция', True, True, True, 3),  # т
        ('2700', 'Углекислота', False, True, True, 3),  # т
        ('2710', 'Меланж', False, True, True, 3),  # т
        ('2720', 'Кондитерские изделия', True, True, True, 3),  # т
        ('2730', 'Масло растительное', False, True, True, 3),  # т
        ('2740', 'Картофелепродукты',False, True, True, 3),  # т
        ('2750', 'Производство соли', False, True, True, 3),  # т
        ('2760', 'Спирт этиловый', False, True, True, 24),  # дал
        ('2770', 'Ликероводочные изделия и вино', False, True, True, 23),  # тыс. дал
        ('2790', 'Лимонная кислота', False, True, True, 3),  # т
        ('2800', 'Очистка зерна', False, False, True, 66),  # пл. т
        ('2810', 'Сушка зерна', True, True, True, 66),  # пл. т
        ('2820', 'Мука', False, True, True, 3),  # т
        ('2830', 'Крупа', False, True, True, 3),  # т
        ('2840', 'Макаронные изделия', False, True, True, 3),  # т
        ('2850', 'Комбикорма сухие, гранулированные и комбинированные', False, True, True, 3),  # т
        ('2855', 'Производство сахара-рафинада', True, True, True, 3),  # т
        ('2860', 'Хлеб и хлебобулочные изделия', True, True, True, 3),  # т
        ('2861', 'Общественное питание', True, True, True, 54),  # усл. блюда
        ('2870', 'Льноволокно', True, True, True, 3),  # т
        ('2880', 'Производство сахара', True, True, True, 3),  # т
        ('2900', 'Содержание свиней', True, True, True, 82),  # голов
        ('2901', 'Содержание свиней (привес)', True, True, True, 3),  # т
        ('2910', 'Содержание крупного рогатого скота', True, True, True, 82),  # голов
        ('2911', 'Содержание крупного рогатого скота (привес)', True, True, True, 3),  # т
        ('2920', 'Содержание птицы', True, True, True, 82),  # голов
        ('2921', 'Содержание птицы (привес)', True, True, True, 3),  # т
        ('2930', 'Производство дрожжей', True, True, True, 3),  # т
        ('2940', 'Производство казеина сухого технического', False, True, True, 3),  # т
        ('2941', 'Производство казеинатов пищевых', False, True, True, 3),  # т
        ('2950', 'Производство яиц', True, True, True, 26),  # тыс. шт.
        ('2960', 'Рыба (живая, обработанная)', True, True, True, 3),  # т
        ('2961', 'Выращивание рыбопосадочного материала', True, True, True, 61),  # тыс. экз
        ('3000', 'Подъем и подача воды', False, False, True, 5),  # тыс. м3
        ('3010', 'Прием, очистка и перекачка сточных вод', False, False, True, 5),  # тыс. м3
        ('3100', 'Строительно-монтажные работы, выполненные собственными силами', True, True, True, 11),  # усл. ед.
        ('3200', 'Ремонтные работы', True, True, True, 27),  # усл. рем
        ('3300', 'Обогрев и вентиляция', True, True, True, 28),  # тыс. м3 сут. °С
        ('3303', 'Кондиционирование', False, True, True, 28),  # тыс. м3 сут. °С
        ('3310', 'Горячее водоснабжение', True, True, True, 58),  # чел.
        ('3320', 'Электрообогрев', False, False, True, 28),  # тыс. м3 сут. °С
        ('3350', 'Уличное освещение', False, False, True, 55),  # усл. свет.
        ('3400', 'Производственные нужды железной дороги', True, True, True, 30),  # 10 тыс. т км брутто
        ('3410', 'Электротяга поездов железной дороги', False, False, True, 30),  # 10 тыс. т км брутто
        ('3430', 'Погрузочно-разгрузочные работы', False, False, True, 37),  # тыс. т км
        ('3500', 'Электротяга городского пассажирского транспорта', False, False, True, 11),  # усл. ед.
        ('3600', 'Отопление теплиц', True, True, True, 28),  # тыс. м3 сут. °С
        ('3610', 'Услуги по складированию и хранению продукции', True, True, True, 67),  # т сут.
        ('3700', 'Инкубация яиц', True, True, True, 26),  # тыс. шт.
        ('3800', 'Изделия из пластмасс', True, True, True, 3),  # т
        ('3900', 'Машины швейные', True, True, True, 36),  # усл. шт
        ('4000', 'Трансформаторы', True, True, True, 36),  # усл. ед.
        ('4010', 'Сельскохозяйственная техника', True, True, True, 36),  # усл. ед.
        ('4020', 'Подшипники', True, True, True, 36),  # усл. ед.
        ('4030', 'Автомобили', True, True, True, 36),  # усл. ед.
        ('4040', 'Электродвигатели', True, True, True, 36),  # усл. ед.
        ('4050', 'Станки металлообрабатывающие', True, True, True, 36),  # усл. ед.
        ('4060', 'Стиральные машины', True, True, True, 36),  # усл. ед.
        ('4070', 'Автобусы', True, True, True, 36),  # усл. ед.
        ('4080', 'Тракторы', True, True, True, 36),  # усл. ед.
        ('4090', 'Мотоциклы', True, True, True, 36),  # усл. ед.
        ('4100', 'Велосипеды', True, True, True, 36),  # усл. ед.
        ('4110', 'Лифты', True, True, True, 36),  # усл. ед.
        ('4120', 'Транспортировка нефти', True, True, True, 39),  # тыс. т км
        ('4130', 'Транспортировка газа', True, True, True, 38),  # млн. м3 км
        ('4140', 'Транспортировка нефтепродуктов', True, True, True, 37),  # тыс. т км
        ('4150', 'Котлы отопительные', True, True, True, 36),  # усл. ед.
        ('4160', 'Холодильники и морозильники бытовые', True, True, True, 36),  # усл. ед.
        ('4170', 'Телевизоры', True, True, True, 36),  # усл. ед.
        ('4180', 'Часы', True, True, True, 36),  # усл. ед.
        ('4190', 'Плиты газовые', True, True, True, 36),  # усл. шт.
        ('4191', 'Прочие товары народного потребления', True, True, True, 36),  # усл. ед.
        ('4200', 'Реализация нефтепродуктов', False, False, True, 3),  # т
        
        ('4201', 'Реализация газа СУГ', False, True, True, 3),  # т
        ('4201', 'Реализация газа', False, True, True, 5),  # тыс. м3
        ('4201', 'Реализация природного газа', False, True, True, 5),  # тыс. м3
        
        ('4202', 'Потери природного газа', True, False, False, 72),  # %
        ('4203', 'Потери сжатого газа', True, False, False, 72),  # %
        ('4210', 'Приборы, средства автоматизации и связи и запасные части к ним', True, True, True, 36),  # усл. ед.
        ('4220', 'Насосы', True, True, True, 36),  # усл. шт.
        ('4226', 'Вентиляторы', True, True, True, 36),  # усл. ед.
        ('4230', 'Двигатели внутреннего сгорания', True, True, True, 36),  # усл. ед.
        ('4240', 'Дорожная техника', True, True, True, 36),  # усл. ед.
        ('4250', 'Мелиоративная техника', True, True, True, 36),  # усл. ед.
        ('4255', 'Орошение земель', False, False, False, 56),  # га
        ('4300', 'Медикаменты в ампулах', False, True, True, 40),  # тыс. ампул
        ('4310', 'Медикаменты в таблетках', False, True, True, 41),  # тыс. упак.
        ('4320', 'Медикаменты во флаконах', False, True, True, 42),  # тыс. флак.
        ('4330', 'Медицинское оборудование и инструменты', True, True, True, 36),  # усл. ед.
        ('4400', 'Судостроение', False, True, True, 43),  # норм. ч
        ('4430', 'Строительная техника', True, True, True, 36),  # усл. шт.
        ('4440', 'Электротехнические изделия', True, True, True, 36),  # усл. шт.
        ('4450', 'Зеркальные изделия', True, True, True, 9),  # м2
        ('4460', 'Кабели и проволока электротехническая', True, True, True, 44),  # усл. км
        ('4470', 'Эмалированные изделия', True, True, True, 20),  # усл. т
        ('4480', 'Посуда', False, True, True, 36),  # усл. ед.
        ('4490', 'Музыкальные инструменты', False, False, True, 36),  # усл. шт.
        ('4600', 'Услуги связи', False, False, True, 78),  # час работы оборудования
        ('4701', 'Бытовое обслуживание', True, True, True, 11),  # усл. ед.
        ('4702', 'Стирка и химчистка белья', True, True, True, 3),  # т
        ('5001', 'Фотоаппараты и оптические изделия', True, True, True, 36),  # усл. ед.
        ('5002', 'Электролампы', True, True, True, 36),  # усл. шт.
        ('5003', 'Продукция машиностроения, запчасти и комплектующие', True, True, True, 36),  # усл. ед.
        ('5004', 'Гидрооборудование', True, True, True, 36),  # усл. шт.
        ('5005', 'Пластик слоистый', True, True, True, 14),  # тыс. м2
        ('5006', 'Тарооборудование', True, True, True, 7),  # шт.
        ('5007', 'Сетчатые мешки полиэтиленовые', False, True, True, 26),  # тыс. шт.
        ('5008', 'Торговое оборудование', True, True, True, 49),  # усл. комплект
        ('5009', 'Капитальный и восстановительный ремонт подвижного состава и его составных частей', False, True, True, 27),  # усл. рем
        ('5010', 'Производство подвижного состава (прицепы, полуприцепы)', True, True, True, 36),  # усл. ед.
        ('5011', 'Техническое обслуживание и ремонт подвижного состава в автотранспортных предприятиях', True, True, True, 50),  # норма-человеко-час
        ('5012', 'Объем работ предприятия газового хозяйства', True, True, True, 36),  # усл. ед.
        ('5013', 'Отопление вагонов', True, False, True, 79),  # вагоно-сут.
        ('5014', 'Шпон строганный синтетический', False, True, True, 14),  # тыс. м2
        ('5015', 'Заготовка и первичная переработка древесины', False, True, True, 5),  # тыс. м3
        ('5016', 'Спички', True, True, True, 52),  # тыс. усл. ящ
        ('5017', 'Услуги по использованию и ремонту автотранспорта', True, True, True, 36),  # усл. ед.
        ('5018', 'Воск и продукция из воска', True, True, True, 3),  # т
        ('5019', 'Игрушки', True, True, True, 36),  # усл. ед.
        ('5020', 'Выращивание цветов и декоративных растений', True, True, True, 26),  # тыс. шт.
        ('5021', 'Деятельность в сфере торговли, образования, культуры, спорта и т.п.', True, True, True, 9),  # м2
        ('5022', 'Услуги гостиниц, санаторно-курортных и лечебных учреждений', True, True, True, 81),  # койко-сут.
        ('5023', 'Места общего пользования общежитий', True, True, True, 62),  # чел., м2
        ('5024', 'Прием, перекачка воды в ЦТП', False, False, True, 10),  # м3
        ('5025', 'Прием, перекачка и очистка стоков', False, False, True, 5),  # тыс. м3
        ('5026', 'Услуги бани', True, True, True, 59),  # посещ.
        ('5027', 'Прессование отходов, вторсырья и ТБО', True, True, True, 3),  # т
        ('6000', 'Другие нормируемые виды продукции (услуг, работ)', True, True, True, 11),  # усл. ед.
        ('7000', 'Предельный уровень потребления (объекты непроизводственного характера, коммунально-бытового назначения и другие)', True, True, True, 11),  # усл. ед.
        ('9001', 'Всего по нормированному потреблению', True, False, False, 53, None, None),
        ('9001', 'Всего по нормированному потреблению', False, False, True, 2, None, None),
        ('9001', 'Всего по нормированному потреблению', False, True, False, 1, None, None),
        ('9010', 'Прочее потребление', True, False, False, 53, None, None),
        ('9010', 'Прочее потребление', False, False, True, 2, None, None),
        ('9010', 'Прочее потребление', False, True, False, 1, None, None),
    ]
        
        
    max_id = db.session.query(db.func.max(DirProduct.id)).scalar() or 0
    current_id = max_id
    
    for data in products_to_add:
        current_id += 1
        product = DirProduct(
                            id=current_id,
                            CodeProduct=data[0], 
                            NameProduct=data[1], 
                            IsFuel=data[2], 
                            IsHeat=data[3], 
                            IsElectro=data[4], 
                            IdUnit=data[5],
                            DateStart=date_start, 
                            DateEnd=None)
        db.session.add(product)
        
    db.session.commit()
    return f"Successfully added {len(products_to_add)} products"
        